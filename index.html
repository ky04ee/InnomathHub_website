<!DOCTYPE html>
<html>
<head>
<title>Innomath Hub</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<style>
body{
    margin: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #4a6bc2 0%, #027499 100%);
    min-height: 100vh;
}

/* üîê ÁôªÂΩï/Ê≥®ÂÜåÈ°µÈù¢Ê†∑Âºè */
.auth-page {
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    padding: 20px;
}

.auth-container {
    max-width: 400px;
    width: 90%;
    background: rgba(255, 255, 255, 0.25);
    border-radius: 15px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.25);
    padding: 40px 30px;
    backdrop-filter: blur(8px);
    border: 1px solid rgba(255, 255, 255, 0.35);
    text-align: center;
}

.auth-logo {
    color: white;
    font-size: 36px;
    font-weight: 700;
    margin-bottom: 10px;
    text-shadow: 0 2px 10px rgba(0,0,0,0.3);
}

.auth-subtitle {
    color: #bbdefb;
    font-size: 16px;
    margin-bottom: 30px;
}

/* ÂàáÊç¢Ê†áÁ≠æÊ†∑Âºè */
.auth-tabs {
    display: flex;
    margin-bottom: 30px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 10px;
    padding: 5px;
}

.auth-tab {
    flex: 1;
    padding: 12px;
    color: white;
    cursor: pointer;
    border-radius: 8px;
    transition: all 0.3s;
    font-weight: 500;
}

.auth-tab.active {
    background: white;
    color: #1a237e;
}

/* Ë°®ÂçïÊ†∑Âºè */
.auth-form {
    display: block;
}

.hidden {
    display: none;
}

.input-group {
    margin-bottom: 20px;
    text-align: left;
}

.input-group label {
    display: block;
    color: white;
    margin-bottom: 8px;
    font-weight: 500;
}

.input-group input {
    width: 100%;
    padding: 14px;
    border: 2px solid rgba(255, 255, 255, 0.3);
    border-radius: 8px;
    background: rgba(255, 255, 255, 0.9);
    font-size: 16px;
    box-sizing: border-box;
    transition: all 0.3s;
}

.input-group input:focus {
    outline: none;
    border-color: #4a6bc2;
    box-shadow: 0 0 0 3px rgba(74, 107, 194, 0.3);
}

.auth-button {
    width: 100%;
    background: white;
    color: #1a237e;
    padding: 16px;
    font-size: 18px;
    font-weight: 700;
    border-radius: 10px;
    border: none;
    cursor: pointer;
    transition: all 0.3s;
    margin-top: 10px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.2);
}

.auth-button:hover {
    background: #f5f5f5;
    transform: translateY(-3px);
    box-shadow: 0 15px 35px rgba(0,0,0,0.3);
}

.error-message {
    color: #d32f2f;
    font-size: 15px;
    margin: 15px 0;
    display: none;
    background: #ffebee;
    padding: 14px;
    border-radius: 8px;
    border: 2px solid #ef5350;
    font-weight: 700;
    text-align: center;
    animation: shake 0.5s ease;
    box-shadow: 0 4px 12px rgba(239, 83, 80, 0.2);
}

@keyframes shake {
    0%, 100% { transform: translateX(0); }
    25% { transform: translateX(-5px); }
    75% { transform: translateX(5px); }
}

.success-message {
    color: #4CAF50;
    font-size: 14px;
    margin-top: 15px;
    display: none;
}

.guest-option {
    margin-top: 25px;
    color: rgba(255, 255, 255, 0.7);
    font-size: 14px;
}

.guest-link {
    color: #bbdefb;
    text-decoration: underline;
    cursor: pointer;
    font-weight: 500;
}

.main-container {
    display: none;
    min-height: 100vh;
    padding: 20px;
    box-sizing: border-box;
}

.container {
    max-width: 800px;
    margin: 0 auto;
    background: rgba(255, 255, 255, 0.25);
    border-radius: 15px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.25);
    overflow: hidden;
    backdrop-filter: blur(8px);
    border: 1px solid rgba(255, 255, 255, 0.35);
}

header{
    padding: 40px 20px;
    color: white;
    background: rgba(255, 255, 255, 0.15);
    border-bottom: 1px solid rgba(255, 255, 255, 0.2);
    text-align: center; 
    display: flex;
    flex-direction: column;
    align-items: center; 
}

header h1{
    margin: 0 0 15px 0;
    font-size: 50px;
    font-weight: 700;
    color: white;
    text-shadow: 0 2px 10px rgba(0,0,0,0.3);
    text-align: center; 
    width: 100%; 
}

.subtitle {
    font-size: 18px;
    color: #ffffff;
    margin-bottom: 20px;
    font-weight: 500;
    text-shadow: 0 1px 3px rgba(0,0,0,0.5);
    text-align: center; 
    width: 100%; 
}

.separator {
    height: 1px;
    background: rgba(255,255,255,0.3);
    margin: 25px auto;
    width: 100px;
    text-align: center; 
}

.tagline {
    font-size: 18px;
    color: #ffffff;
    font-weight: 500;
    margin-top: 15px;
    text-shadow: 0 1px 3px rgba(0,0,0,0.5);
    text-align: center; 
    width: 100%; 
}

.main-content {
    padding: 40px 20px;
}

.section-title {
    color: white;
    font-size: 28px;
    margin-bottom: 25px;
    font-weight: 600;
    text-align:center;
}

.main-button {
    display: block;
    background: white;
    color: #1a237e;
    padding: 18px 30px;
    font-size: 20px;
    font-weight: 700;
    border-radius: 10px;
    text-decoration: none;
    margin: 15px auto;
    transition: all 0.3s;
    border: none;
    cursor: pointer;
    width: 320px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.2);
}

.main-button:hover {
    background: #f5f5f5;
    transform: translateY(-5px);
    box-shadow: 0 15px 35px rgba(0,0,0,0.3);
}

.file-options {
    display: none;
    padding: 40px 20px;
}

.file-title {
    color: white;
    font-size: 24px;
    margin-bottom: 30px;
    font-weight: 600;
    text-align:center;
}

.file-button {
    display: block;
    background: rgba(255, 255, 255, 0.9);
    color: #1a237e;
    padding: 18px 40px;
    font-size: 18px;
    font-weight: 600;
    border-radius: 10px;
    text-decoration: none;
    margin: 15px auto;
    transition: all 0.3s;
    border: none;
    cursor: pointer;
    width: 280px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
}

.file-button:hover {
    background: white;
    transform: translateY(-3px);
    box-shadow: 0 10px 25px rgba(0,0,0,0.3);
}

.back-button {
    display: inline-block;
    background: rgba(255, 255, 255, 0.2);
    color: white;
    padding: 12px 30px;
    font-size: 14px;
    font-weight: 500;
    border-radius: 8px;
    text-decoration: none;
    margin-top: 30px;
    transition: all 0.3s;
    border: 1px solid rgba(255,255,255,0.3);
    cursor: pointer;
}

.back-button:hover {
    background: rgba(255, 255, 255, 0.3);
}

/* Chatbot Ê†∑Âºè */
.chatbot-container {
    position: fixed;
    bottom: 30px;
    right: 30px;
    width: 350px;
    height: 500px;
    background: white;
    border-radius: 15px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    z-index: 1000;
    overflow: hidden;
    display: none;
    flex-direction: column;
    border: 1px solid rgba(255, 255, 255, 0.3);
}

.chatbot-header {
    background: linear-gradient(135deg, #4a6bc2 0%, #027499 100%);
    color: white;
    padding: 15px 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    cursor: pointer;
    font-weight: 600;
    font-size: 16px;
}

.chatbot-toggle {
    font-size: 20px;
    font-weight: bold;
}

.chatbot-body {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

.chatbot-messages {
    flex: 1;
    padding: 20px;
    overflow-y: auto;
    background: #f8f9fa;
}

.message {
    margin-bottom: 15px;
    padding: 12px 15px;
    border-radius: 10px;
    max-width: 85%;
    line-height: 1.4;
}

.bot-message {
    background: #e3f2fd;
    border-left: 4px solid #4a6bc2;
    margin-right: auto;
}

.user-message {
    background: #4a6bc2;
    color: white;
    margin-left: auto;
    border-left: 4px solid #027499;
}

.chatbot-input {
    padding: 15px;
    border-top: 1px solid #e0e0e0;
    background: white;
    display: flex;
    gap: 10px;
}

.chatbot-input input {
    flex: 1;
    padding: 12px 15px;
    border: 2px solid #e0e0e0;
    border-radius: 8px;
    font-size: 14px;
}

.chatbot-input input:focus {
    outline: none;
    border-color: #4a6bc2;
}

.chatbot-input button {
    background: #4a6bc2;
    color: white;
    border: none;
    padding: 0 20px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 600;
    transition: background 0.3s;
}

.chatbot-input button:hover {
    background: #027499;
}

/* Chatbot ÂàáÊç¢ÊåâÈíÆ */
.chatbot-toggle-btn {
    position: fixed;
    bottom: 30px;
    right: 30px;
    width: 60px;
    height: 60px;
    background: linear-gradient(135deg, #4a6bc2 0%, #027499 100%);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 24px;
    cursor: pointer;
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
    z-index: 999;
    border: 2px solid white;
    transition: transform 0.3s;
}

.chatbot-toggle-btn:hover {
    transform: scale(1.1);
}

/* Á°Æ‰øùÂÆπÂô®ÊúâË∂≥Â§üÁöÑÂ∫ïÈÉ®Èó¥Ë∑ù */
.container {
    padding-bottom: 20px !important;
}

.file-options {
    padding-bottom: 40px !important;
}

/* ÂìçÂ∫îÂºèËÆæËÆ° */
@media (max-width: 768px) {
    .chatbot-container {
        width: 90%;
        right: 5%;
        bottom: 20px;
        height: 400px;
    }
    
    .chatbot-toggle-btn {
        bottom: 20px;
        right: 20px;
        width: 50px;
        height: 50px;
        font-size: 20px;
    }
    
    .main-container {
        padding: 10px;
    }
}

footer {
    padding: 20px;
    color: rgba(255, 255, 255, 0.7);
    font-size: 14px;
    border-top: 1px solid rgba(255,255,255,0.1);
    text-align: center;
}

/* ËøõÂ∫¶Êù°Ê†∑Âºè */
.progress-section-bottom {
    margin: 50px auto 30px auto;
    padding: 25px;
    background: rgba(255, 255, 255, 0.15);
    border-radius: 15px;
    border: 1px solid rgba(255, 255, 255, 0.2);
    max-width: 500px;
}

.progress-title {
    color: white;
    font-size: 20px;
    margin-bottom: 20px;
    text-align: center;
    font-weight: 600;
}

.progress-container {
    margin-bottom: 20px;
}

.progress-label {
    display: flex;
    justify-content: space-between;
    margin-bottom: 8px;
    color: white;
    font-size: 15px;
    font-weight: 500;
}

.progress-percent {
    color: #FFD700;
    font-weight: 600;
}

.progress-bar {
    height: 10px;
    background: rgba(255, 255, 255, 0.2);
    border-radius: 5px;
    overflow: hidden;
}

.progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #4FC3F7, #2979FF);
    border-radius: 5px;
    transition: width 0.5s ease;
}

.progress-actions {
    text-align: center;
    margin-top: 20px;
}

.update-btn {
    background: rgba(255, 255, 255, 0.2);
    color: white;
    border: 1px solid rgba(255, 255, 255, 0.3);
    padding: 8px 16px;
    border-radius: 6px;
    cursor: pointer;
    margin-bottom: 8px;
}

.update-btn:hover {
    background: rgba(255, 255, 255, 0.3);
}

.progress-actions small {
    color: rgba(255, 255, 255, 0.7);
    font-size: 12px;
}

</style>
</head>
<body>

<!-- üîê ÁôªÂΩï/Ê≥®ÂÜåÈ°µÈù¢ -->
<div class="auth-page" id="authPage">
    <div class="auth-container">
        <div class="auth-logo">INNOMATH HUB</div>
        <div class="auth-subtitle">Your Ultimate Study Companion</div>
        
        <!-- ÂàáÊç¢Ê†áÁ≠æ -->
        <div class="auth-tabs">
            <div class="auth-tab active" onclick="showLoginForm()">LOGIN</div>
            <div class="auth-tab" onclick="showRegisterForm()">CREATE ACCOUNT</div>
        </div>
        
        <!-- ÁôªÂΩïË°®Âçï -->
        <form class="auth-form" id="loginForm" onsubmit="event.preventDefault(); login();">
            <div class="input-group">
                <label for="loginUsername">Username</label>
                <input type="text" id="loginUsername" placeholder="Enter your username" required>
            </div>
            
            <div class="input-group">
                <label for="loginPassword">Password</label>
                <input type="password" id="loginPassword" placeholder="Enter your password" required>
            </div>
            
            <div class="error-message" id="loginError">
                Invalid username or password
            </div>
            
            <button type="submit" class="auth-button">LOGIN</button>
            
            <div class="guest-option">
                Or continue as <span class="guest-link" onclick="continueAsGuest()">Guest</span>
            </div>
        </form>
        
        <!-- Ê≥®ÂÜåË°®Âçï -->
        <form class="auth-form hidden" id="registerForm" onsubmit="event.preventDefault(); register();">
            <div class="input-group">
                <label for="regUsername">Username</label>
                <input type="text" id="regUsername" placeholder="Choose a username" required>
            </div>
            
            <div class="input-group">
                <label for="regEmail">Email</label>
                <input type="email" id="regEmail" placeholder="Enter your email" required>
            </div>
            
            <div class="input-group">
                <label for="regPassword">Password</label>
                <input type="password" id="regPassword" placeholder="Choose a password" required>
            </div>
            
            <div class="input-group">
                <label for="regConfirmPassword">Confirm Password</label>
                <input type="password" id="regConfirmPassword" placeholder="Confirm password" required>
            </div>
            
            <div class="error-message" id="registerError">
                Passwords do not match or username already exists
            </div>
            
            <div class="success-message" id="registerSuccess">
                Account created successfully! Please login.
            </div>
            
            <button type="submit" class="auth-button">CREATE ACCOUNT</button>
            
            <div class="guest-option">
                Already have an account? <span class="guest-link" onclick="showLoginForm()">Login here</span>
            </div>
        </form>
    </div>
</div>

<!-- ‰∏ªÂÜÖÂÆπ -->
<div class="main-container" id="mainContainer">
    <div class="container">
        <header>
            <h1>INNOMATH HUB</h1>
            <div class="subtitle">Practice today, conquer tomorrow.</div>
            
            <div class="separator"></div>
            
            <div class="tagline">Your Ultimate Study Companion</div>
        </header>
        
        <div class="main-content" id="mainContent">
            <div class="section-title">Study Materials</div>
            <button class="main-button" onclick="showNotesOptions()">üìö TOPIC 9 NOTES</button>
            <button class="main-button" onclick="showFileOptions()">üñäTOPIC 9 QUESTIONS</button>
            <button class="main-button" onclick="completeQuizActivity(); openGoogleForm()">TOPIC 9 QUIZ</button>
            <button class="main-button" onclick="showYoutubeOptions()">üé¶VIDEO TUTORIALS</button>
            <button class="main-button" onclick="openDerivativeCalculator()">üßÆ DERIVATIVE CALCULATOR</button>
        </div>
        
        <!-- Notes ÈÄâÈ°π -->
        <div class="file-options" id="notesOptions">
            <div class="file-title">Topic 9 Notes</div>
            <a href="https://drive.google.com/file/d/16_jSmVaoJKcnJCCuXYl7wZVzBkrEoBaH/view?usp=sharing" 
                class="file-button" 
                target="_blank" 
                onclick="completeTopicActivity()">üìï9.1 Derivative of a Function</a>
    
            <a href="https://drive.google.com/file/d/1mdlXCoYiOnMnownloDByVwjqIxsiQIg-/view?usp=sharing" 
                class="file-button" 
                target="_blank" 
                onclick="completeTopicActivity()">üìó9.2 Rules of Differentiation</a>
    
            <a href="https://drive.google.com/file/d/1VOWfXG9TSq88WxZVSwzj0S45_XqbNCxr/view?usp=sharing" 
                class="file-button" 
                target="_blank" 
                onclick="completeTopicActivity()">üìò9.3 Differentiation of exponential, logarithmic and trigonometric functions</a>
            
            <a href="https://drive.google.com/file/d/1XuAKGoUIFceA3Ln_SjEroZ-p_McVqFSo/view?usp=sharing" 
                class="file-button" 
                target="_blank" 
                onclick="completeTopicActivity()">üìò9.4 Implicit Differentiation</a>
            
            <a href="https://drive.google.com/file/d/153zDNWB7Gvu4xE65Q1yn3Azs1oVHcgPA/view?usp=sharing" 
                class="file-button" 
                target="_blank" 
                onclick="completeTopicActivity()">üìò9.5 Parametric Differentiation</a>
            
            <button class="back-button" onclick="hideNotesOptions()">‚Üê Back to Main</button>
        </div>
        
        <div class="file-options" id="fileOptions">
            <div class="file-title">Select File </div>
            <a href="https://drive.google.com/file/d/1n-8998E7Znrykz5ZyOHFDv94RhMYDno4/view?usp=sharing" class="file-button" target="_blank" onclick="completeTopicActivity()">KMNS</a>
            <a href="https://drive.google.com/file/d/1AP6yhfksl5VfavpI-S6dts6z3vslP9YO/view?usp=sharing" class="file-button" target="_blank" onclick="completeTopicActivity()">KMM</a>
            <a href="https://drive.google.com/file/d/1qZly6g2X6s4MaT1wkZ48n9B0Fg0oEQGN/view?usp=sharing" class="file-button" target="_blank" onclick="completeTopicActivity()">KMPK</a>
            <button class="back-button" onclick="hideFileOptions()">‚Üê Back to Main</button>
        </div>
        
        <div class="file-options" id="youtubeOptions">
            <div class="file-title">Differentiation Tutorials</div>
            <a href="https://www.youtube.com/watch?v=5yfh5cf4-0w" class="file-button" target="_blank" onclick="completeVideoActivity()">üìò Differentiation Basics</a>
            <a href="https://www.youtube.com/watch?v=WUvTyaaNkzM" class="file-button" target="_blank" onclick="completeVideoActivity()">üìó Chain Rule Tutorial</a>
            <a href="https://www.youtube.com/watch?v=YG15m2VwSjA" class="file-button" target="_blank" onclick="completeVideoActivity()">üìô Product & Quotient Rules</a>
            <a href="https://www.youtube.com/watch?v=ANyVpMS3HL4" class="file-button" target="_blank" onclick="completeVideoActivity()">üìí Applications of Derivatives</a>
            <button class="back-button" onclick="hideYoutubeOptions()">‚Üê Back to Main</button>
        </div>

        <!-- ËøõÂ∫¶Êù°ÈÉ®ÂàÜ -->
        <div class="progress-section-bottom" id="progressSection">
            <h3 class="progress-title">üìä Your Learning Progress</h3>
            
            <div class="progress-container">
                <div class="progress-label">
                    <span>Topic 9 Completion</span>
                    <span class="progress-percent" id="topicProgress">0%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="topicBar" style="width: 0%"></div>
                </div>
            </div>
            
            <div class="progress-container">
                <div class="progress-label">
                    <span>Quiz Performance</span>
                    <span class="progress-percent" id="quizProgress">0%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="quizBar" style="width: 0%"></div>
                </div>
            </div>
            
            <div class="progress-container">
                <div class="progress-label">
                    <span>Video Tutorials Watched</span>
                    <span class="progress-percent" id="videoProgress">0%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="videoBar" style="width: 0%"></div>
                </div>
            </div>
            
            <!-- ËøõÂ∫¶Êìç‰ΩúÊåâÈíÆ -->
            <div class="progress-actions">
                <button class="update-btn" onclick="resetProgress()" style="background: rgba(255,0,0,0.2);">Reset Progress</button>
            </div>
        </div>
        
        <footer>
            ¬© 2026 Innomathematics Hub. All rights reserved.
        </footer>
    </div>
</div>

<!-- Chatbot ÂÆπÂô® -->
<div class="chatbot-container" id="chatbotContainer">
    <div class="chatbot-header" onclick="toggleChatbot()">
        <span>ü§ñ Math Buddy</span>
        <span class="chatbot-toggle">‚àí</span>
    </div>
    
    <div class="chatbot-body">
        <div class="chatbot-messages" id="chatbotMessages">
            <div class="message bot-message">
                Hi! I'm your <strong>Math Formula Helper</strong>. I can provide:
                <br>‚Ä¢ Differentiation rules & formulas
                <br>‚Ä¢ Integration formulas  
                <br>‚Ä¢ Common math formulas
                <br><br><strong>Try asking:</strong>
                <br>"power rule formula"
                <br>"integration formulas"
            </div>
        </div>
        
        <div class="chatbot-input">
            <input type="text" id="chatbotInput" placeholder="Ask a math question...">
            <button onclick="sendChatbotMessage()">Send</button>
        </div>
    </div>
</div>

<!-- Chatbot ÂàáÊç¢ÊåâÈíÆ -->
<div class="chatbot-toggle-btn" id="chatbotToggleBtn" onclick="toggleChatbot()">ü§ñ</div>

<script>
// Â≠òÂÇ®Áî®Êà∑Êï∞ÊçÆ
let users = JSON.parse(localStorage.getItem('innomath_users')) || [
    {username: 'admin', email: 'admin@example.com', password: '1234'}
];

// ÂàáÊç¢Ë°®ÂçïÊòæÁ§∫
function showLoginForm() {
    document.getElementById('loginForm').classList.remove('hidden');
    document.getElementById('registerForm').classList.add('hidden');
    document.querySelectorAll('.auth-tab')[0].classList.add('active');
    document.querySelectorAll('.auth-tab')[1].classList.remove('active');
    clearMessages();
}

function showRegisterForm() {
    document.getElementById('loginForm').classList.add('hidden');
    document.getElementById('registerForm').classList.remove('hidden');
    document.querySelectorAll('.auth-tab')[0].classList.remove('active');
    document.querySelectorAll('.auth-tab')[1].classList.add('active');
    clearMessages();
}

function clearMessages() {
    document.getElementById('loginError').style.display = 'none';
    document.getElementById('registerError').style.display = 'none';
    document.getElementById('registerSuccess').style.display = 'none';
}

// Ê≥®ÂÜåÂäüËÉΩ
function register() {
    const username = document.getElementById('regUsername').value.trim();
    const email = document.getElementById('regEmail').value.trim();
    const password = document.getElementById('regPassword').value;
    const confirmPassword = document.getElementById('regConfirmPassword').value;
    
    const errorElement = document.getElementById('registerError');
    const successElement = document.getElementById('registerSuccess');
    
    errorElement.style.display = 'none';
    successElement.style.display = 'none';
    
    if (password !== confirmPassword) {
        errorElement.textContent = 'Passwords do not match';
        errorElement.style.display = 'block';
        return;
    }
    
    if (password.length < 4) {
        errorElement.textContent = 'Password must be at least 4 characters';
        errorElement.style.display = 'block';
        return;
    }
    
    if (users.some(user => user.username === username)) {
        errorElement.textContent = 'Username already exists';
        errorElement.style.display = 'block';
        return;
    }
    
    if (users.some(user => user.email === email)) {
        errorElement.textContent = 'Email already registered';
        errorElement.style.display = 'block';
        return;
    }
    
    const newUser = {
        username: username,
        email: email,
        password: password
    };
    
    users.push(newUser);
    localStorage.setItem('innomath_users', JSON.stringify(users));
    
    successElement.textContent = 'Account created successfully! Please login.';
    successElement.style.display = 'block';
    
    document.getElementById('regUsername').value = '';
    document.getElementById('regEmail').value = '';
    document.getElementById('regPassword').value = '';
    document.getElementById('regConfirmPassword').value = '';
    
    setTimeout(() => {
        showLoginForm();
        document.getElementById('loginUsername').value = username;
    }, 2000);
}

// ÁôªÂΩïÂäüËÉΩ
function login() {
    const username = document.getElementById('loginUsername').value.trim();
    const password = document.getElementById('loginPassword').value;
    const errorElement = document.getElementById('loginError');
    
    errorElement.style.display = 'none';
    
    const user = users.find(u => u.username === username && u.password === password);
    
    if (user) {
        document.getElementById('authPage').style.display = 'none';
        document.getElementById('mainContainer').style.display = 'block';
        localStorage.setItem('current_user', JSON.stringify(user));
        
        // ÊòæÁ§∫ËøõÂ∫¶Êù°
        document.getElementById('progressSection').style.display = 'block';
        loadProgress();
        
        // ÊòæÁ§∫ Chatbot ÊåâÈíÆ
        document.getElementById('chatbotToggleBtn').style.display = 'flex';
    } else {
        errorElement.style.display = 'block';
    }
}

// ËÆøÂÆ¢ËÆøÈóÆ
function continueAsGuest() {
    document.getElementById('authPage').style.display = 'none';
    document.getElementById('mainContainer').style.display = 'block';
    document.getElementById('progressSection').style.display = 'block';
    loadProgress();
    
    // ÊòæÁ§∫ Chatbot ÊåâÈíÆ
    document.getElementById('chatbotToggleBtn').style.display = 'flex';
}

// ÊòæÁ§∫ Notes ÈÄâÈ°π
function showNotesOptions() {
    document.getElementById('mainContent').style.display = 'none';
    document.getElementById('notesOptions').style.display = 'block';
    document.getElementById('progressSection').style.display = 'none';
}

// ÈöêËóè Notes ÈÄâÈ°π
function hideNotesOptions() {
    document.getElementById('notesOptions').style.display = 'none';
    document.getElementById('mainContent').style.display = 'block';
    document.getElementById('progressSection').style.display = 'block';
}

// È°µÈù¢ÂàáÊç¢
function showFileOptions() {
    document.getElementById('mainContent').style.display = 'none';
    document.getElementById('fileOptions').style.display = 'block';
    document.getElementById('progressSection').style.display = 'none';
}

function hideFileOptions() {
    document.getElementById('fileOptions').style.display = 'none';
    document.getElementById('youtubeOptions').style.display = 'none';
    document.getElementById('notesOptions').style.display = 'none';
    document.getElementById('mainContent').style.display = 'block';
    document.getElementById('progressSection').style.display = 'block';
}

function showYoutubeOptions() {
    document.getElementById('mainContent').style.display = 'none';
    document.getElementById('youtubeOptions').style.display = 'block';
    document.getElementById('progressSection').style.display = 'none';
}

function hideYoutubeOptions() {
    document.getElementById('youtubeOptions').style.display = 'none';
    document.getElementById('notesOptions').style.display = 'none'; 
    document.getElementById('mainContent').style.display = 'block';
    document.getElementById('progressSection').style.display = 'block';
}

function openGoogleForm() {
    window.open('https://forms.gle/iuWpAK8gUEqwYqVp8', '_blank');
}

// ËøõÂ∫¶ÁÆ°ÁêÜ
function updateProgress(topicPercent, quizPercent, videoPercent) {
    document.getElementById('topicProgress').textContent = topicPercent + '%';
    document.getElementById('quizProgress').textContent = quizPercent + '%';
    document.getElementById('videoProgress').textContent = videoPercent + '%';
    
    document.getElementById('topicBar').style.width = topicPercent + '%';
    document.getElementById('quizBar').style.width = quizPercent + '%';
    document.getElementById('videoBar').style.width = videoPercent + '%';
    
    localStorage.setItem('progress', JSON.stringify({
        topic: topicPercent,
        quiz: quizPercent,
        video: videoPercent
    }));
}

function loadProgress() {
    const savedProgress = localStorage.getItem('progress');
    if (savedProgress) {
        const progress = JSON.parse(savedProgress);
        updateProgress(progress.topic, progress.quiz, progress.video);
    } else {
        // ËÆæÁΩÆÂàùÂßãÂÄº‰∏∫ 0, 0, 0
        updateProgress(0, 0, 0);
    }
}

// Ëá™Âä®Ë∑üË∏™ËøõÂ∫¶ - Áî®Êà∑ÁÇπÂáªÊåâÈíÆÊó∂Ëá™Âä®Êõ¥Êñ∞
function completeTopicActivity() {
    const progress = JSON.parse(localStorage.getItem('progress') || '{"topic":0,"quiz":0,"video":0}');
    if (progress.topic < 100) {
        progress.topic = Math.min(100, progress.topic + 10);
        updateProgress(progress.topic, progress.quiz, progress.video);
    }
}

function completeQuizActivity() {
    const progress = JSON.parse(localStorage.getItem('progress') || '{"topic":0,"quiz":0,"video":0}');
    if (progress.quiz < 100) {
        progress.quiz = Math.min(100, progress.quiz + 15);
        updateProgress(progress.topic, progress.quiz, progress.video);
        alert('Well done! Quiz progress increased by 15%');
    }
}

function completeVideoActivity() {
    const progress = JSON.parse(localStorage.getItem('progress') || '{"topic":0,"quiz":0,"video":0}');
    if (progress.video < 100) {
        progress.video = Math.min(100, progress.video + 25);
        updateProgress(progress.topic, progress.quiz, progress.video);
        alert('Good job! Video progress increased by 25%');
    }
}

// ÈáçÁΩÆËøõÂ∫¶Âà∞ 0, 0, 0
function resetProgress() {
    if (confirm('Are you sure you want to reset all progress to 0%?')) {
        updateProgress(0, 0, 0);
        alert('Progress has been reset to 0%');
    }
}

function openDerivativeCalculator() {
    window.open('https://www.wolframalpha.com/calculators/derivative-calculator/', '_blank');
}

// ÊåâEnterÈîÆÊèê‰∫§Ë°®Âçï
document.addEventListener('keypress', function(event) {
    if (event.key === 'Enter') {
        if (!document.getElementById('loginForm').classList.contains('hidden')) {
            login();
        } else if (!document.getElementById('registerForm').classList.contains('hidden')) {
            register();
        }
    }
});

// È°µÈù¢Âä†ËΩΩÊó∂ÂàùÂßãÂåñ
document.addEventListener('DOMContentLoaded', function() {
    showLoginForm();
    // Chatbot ÊåâÈíÆÈªòËÆ§ÈöêËóè
    document.getElementById('chatbotToggleBtn').style.display = 'none';
});

// Chatbot ÂäüËÉΩ
let chatbotOpen = false;

// ÂàáÊç¢ Chatbot ÊòæÁ§∫/ÈöêËóè
function toggleChatbot() {
    const chatbot = document.getElementById('chatbotContainer');
    const toggleBtn = document.getElementById('chatbotToggleBtn');
    
    if (chatbotOpen) {
        chatbot.style.display = 'none';
        toggleBtn.style.display = 'flex';
        chatbotOpen = false;
    } else {
        chatbot.style.display = 'flex';
        toggleBtn.style.display = 'none';
        chatbotOpen = true;
        
        // ÊªöÂä®Âà∞Â∫ïÈÉ®
        setTimeout(() => {
            const messages = document.getElementById('chatbotMessages');
            if (messages) messages.scrollTop = messages.scrollHeight;
        }, 100);
    }
}

// ÂèëÈÄÅÊ∂àÊÅØ
function sendChatbotMessage() {
    const input = document.getElementById('chatbotInput');
    const message = input.value.trim();
    
    if (!message) return;
    
    // ÊòæÁ§∫Áî®Êà∑Ê∂àÊÅØ
    addMessage(message, 'user');
    input.value = '';
    
    // Ê®°ÊãüÊÄùËÄÉ‰∏≠...
    setTimeout(() => {
        // Ëé∑ÂèñÊú∫Âô®‰∫∫ÂõûÂ§ç
        const reply = getBotReply(message);
        addMessage(reply, 'bot');
    }, 500);
}

// Ê∑ªÂä†Ê∂àÊÅØÂà∞ËÅäÂ§©ÁïåÈù¢
function addMessage(text, sender) {
    const messages = document.getElementById('chatbotMessages');
    const messageDiv = document.createElement('div');
    messageDiv.className = `message ${sender}-message`;
    messageDiv.innerHTML = text.replace(/\n/g, '<br>');
    messages.appendChild(messageDiv);
    
    // ÊªöÂä®Âà∞Â∫ïÈÉ®
    messages.scrollTop = messages.scrollHeight;
    
    // Â¶ÇÊûúÊúâ MathJaxÔºåÂà∑Êñ∞Êï∞Â≠¶ÂÖ¨Âºè
    if (window.MathJax) {
        MathJax.typesetPromise([messageDiv]).catch(err => console.log('MathJax error:', err));
    }
}

// ‰ºòÂåñÂêéÁöÑ getBotReply ÂáΩÊï∞
function getBotReply(userMessage) {
    const message = userMessage.toLowerCase().trim();
    
    // ÈóÆÂÄôËØ≠
    if (message.includes('hello') || message.includes('hi') || message.includes('hey')) {
        return "Hi! I'm your **Math Formula Assistant**. Ask me for specific formulas like 'power rule', 'chain rule', or 'ln derivative'.";
    }
    
    // Ê†πÊçÆÂÖ≥ÈîÆËØçÊèê‰æõÂØπÂ∫îÁöÑÂÖ¨Âºè
    if (message.includes('power rule')) {
        return getPowerRuleFormula();
    }
    
    if (message.includes('chain rule')) {
        return getChainRuleFormula();
    }
    
    if (message.includes('product rule')) {
        return getProductRuleFormula();
    }
    
    if (message.includes('quotient rule')) {
        return getQuotientRuleFormula();
    }
    
    if (message.includes('ln') || message.includes('logarithm')) {
        return getLogarithmFormula(message);
    }
    
    if (message.includes('sin') || message.includes('cos') || message.includes('tan') || message.includes('trig')) {
        return getTrigonometricFormula(message);
    }
    
    if (message.includes('e^') || message.includes('exponential') || message.includes('exp')) {
        return getExponentialFormula();
    }
    
    if (message.includes('derivative') || message.includes('differentiate')) {
        return getDerivativeFormulas();
    }
    
    if (message.includes('integral') || message.includes('integrate')) {
        return getIntegrationFormulas();
    }
    
    if (message.includes('help') || message.includes('what can') || message.includes('formula')) {
        return getFormulaIndex();
    }
    
    // ÈªòËÆ§ÂõûÂ§ç
    return "I provide math formulas! Try asking for:\n‚Ä¢ 'power rule formula'\n‚Ä¢ 'chain rule formula'\n‚Ä¢ 'ln derivative formula'\n‚Ä¢ 'integration formulas'\n‚Ä¢ 'trigonometric derivatives'";
}

// ‰∏ìÈó®Êèê‰æõÂÖ¨ÂºèÁöÑÂáΩÊï∞
function getPowerRuleFormula() {
    return `**Power Rule Formula:**
    
\\(\\frac{d}{dx}[x^n] = nx^{n-1}\\)

**Examples:**
\\(\\frac{d}{dx}[x^3] = 3x^2\\)
\\(\\frac{d}{dx}[x^{-2}] = -2x^{-3}\\)
\\(\\frac{d}{dx}[\\sqrt{x}] = \\frac{1}{2\\sqrt{x}}\\)`;
}

function getChainRuleFormula() {
    return `**Chain Rule Formula:**
    
\\(\\frac{d}{dx}[f(g(x))] = f'(g(x)) \\cdot g'(x)\\)

**Alternative notation:**
If \\(y = f(u)\\) and \\(u = g(x)\\), then
\\(\\frac{dy}{dx} = \\frac{dy}{du} \\cdot \\frac{du}{dx}\\)

**Example:**
\\(\\frac{d}{dx}[\\sin(x^2)] = \\cos(x^2) \\cdot 2x\\)`;
}

function getProductRuleFormula() {
    return `**Product Rule Formula:**
    
\\(\\frac{d}{dx}[u(x)v(x)] = u'(x)v(x) + u(x)v'(x)\\)

**Example:**
\\(\\frac{d}{dx}[x \\sin(x)] = \\sin(x) + x\\cos(x)\\)`;
}

function getQuotientRuleFormula() {
    return `**Quotient Rule Formula:**
    
\\(\\frac{d}{dx}\\left[\\frac{u(x)}{v(x)}\\right] = \\frac{u'(x)v(x) - u(x)v'(x)}{[v(x)]^2}\\)

**Example:**
\\(\\frac{d}{dx}\\left[\\frac{\\sin(x)}{x}\\right] = \\frac{x\\cos(x) - \\sin(x)}{x^2}\\)`;
}

function getLogarithmFormula(message) {
    if (message.includes('5x') || message.includes('ln(')) {
        return `**Logarithm Derivative Formulas:**
        
Basic: \\(\\frac{d}{dx}[\\ln(x)] = \\frac{1}{x}\\)

Chain rule version: \\(\\frac{d}{dx}[\\ln(f(x))] = \\frac{f'(x)}{f(x)}\\)

**Specific cases:**
\\(\\frac{d}{dx}[\\ln(5x)] = \\frac{1}{x}\\)
\\(\\frac{d}{dx}[\\ln(x^2)] = \\frac{2}{x}\\)
\\(\\frac{d}{dx}[\\ln(\\sin(x))] = \\cot(x)\\)`;
    }
    
    return `**Logarithm Derivative:**
    
\\(\\frac{d}{dx}[\\ln(x)] = \\frac{1}{x}\\)

\\(\\frac{d}{dx}[\\log_a(x)] = \\frac{1}{x \\ln(a)}\\)`;
}

function getTrigonometricFormula(message) {
    return `**Trigonometric Derivatives:**
    
\\(\\frac{d}{dx}[\\sin(x)] = \\cos(x)\\)
\\(\\frac{d}{dx}[\\cos(x)] = -\\sin(x)\\)
\\(\\frac{d}{dx}[\\tan(x)] = \\sec^2(x)\\)
\\(\\frac{d}{dx}[\\cot(x)] = -\\csc^2(x)\\)
\\(\\frac{d}{dx}[\\sec(x)] = \\sec(x)\\tan(x)\\)
\\(\\frac{d}{dx}[\\csc(x)] = -\\csc(x)\\cot(x)\\)

**Chain rule examples:**
\\(\\frac{d}{dx}[\\sin(ax)] = a\\cos(ax)\\)
\\(\\frac{d}{dx}[\\cos(x^2)] = -2x\\sin(x^2)\\)`;
}

function getExponentialFormula() {
    return `**Exponential Derivatives:**
    
\\(\\frac{d}{dx}[e^x] = e^x\\)
\\(\\frac{d}{dx}[a^x] = a^x \\ln(a)\\)
\\(\\frac{d}{dx}[e^{f(x)}] = e^{f(x)} \\cdot f'(x)\\)
\\(\\frac{d}{dx}[a^{f(x)}] = a^{f(x)} \\ln(a) \\cdot f'(x)\\)

**Examples:**
\\(\\frac{d}{dx}[e^{2x}] = 2e^{2x}\\)
\\(\\frac{d}{dx}[2^x] = 2^x \\ln(2)\\)
\\(\\frac{d}{dx}[e^{x^2}] = 2xe^{x^2}\\)`;
}

function getDerivativeFormulas() {
    return `**Basic Derivative Formulas:**

**Power Rules:**
\\(\\frac{d}{dx}[c] = 0\\) (constant)
\\(\\frac{d}{dx}[x^n] = nx^{n-1}\\) (power rule)
\\(\\frac{d}{dx}[cf(x)] = cf'(x)\\) (constant multiple)

**Sum/Difference:**
\\(\\frac{d}{dx}[f(x) \\pm g(x)] = f'(x) \\pm g'(x)\\)

**Product/Quotient:**
\\(\\frac{d}{dx}[f(x)g(x)] = f'(x)g(x) + f(x)g'(x)\\)
\\(\\frac{d}{dx}\\left[\\frac{f(x)}{g(x)}\\right] = \\frac{f'(x)g(x) - f(x)g'(x)}{[g(x)]^2}\\)

**Chain Rule:**
\\(\\frac{d}{dx}[f(g(x))] = f'(g(x)) \\cdot g'(x)\\)`;
}

function getIntegrationFormulas() {
    return `**Basic Integration Formulas:**

**Power Rule:**
\\(\\int x^n \\, dx = \\frac{x^{n+1}}{n+1} + C\\) (for \\(n \\neq -1\\))

**Exponential:**
\\(\\int e^x \\, dx = e^x + C\\)
\\(\\int a^x \\, dx = \\frac{a^x}{\\ln(a)} + C\\)

**Trigonometric:**
\\(\\int \\sin(x) \\, dx = -\\cos(x) + C\\)
\\(\\int \\cos(x) \\, dx = \\sin(x) + C\\)
\\(\\int \\sec^2(x) \\, dx = \\tan(x) + C\\)

**Logarithmic:**
\\(\\int \\frac{1}{x} \\, dx = \\ln|x| + C\\)

**Rules:**
\\(\\int [f(x) + g(x)] \\, dx = \\int f(x) \\, dx + \\int g(x) \\, dx\\)
\\(\\int cf(x) \\, dx = c \\int f(x) \\, dx\\)`;
}

function getFormulaIndex() {
    return `**Available Formula Categories:**

**Differentiation:**
‚Ä¢ 'power rule formula'
‚Ä¢ 'chain rule formula' 
‚Ä¢ 'product rule formula'
‚Ä¢ 'quotient rule formula'
‚Ä¢ 'ln derivative formula'
‚Ä¢ 'trigonometric derivatives'
‚Ä¢ 'exponential derivatives'
‚Ä¢ 'all derivative formulas'

**Integration:**
‚Ä¢ 'integration formulas'
‚Ä¢ 'basic integrals'

**Specific Functions:**
‚Ä¢ 'derivative of sin(ax)'
‚Ä¢ 'derivative of ln(5x)'
‚Ä¢ 'derivative of e^x'
‚Ä¢ 'integral of x^n'

**Simply ask for the formula you need!**`;
}

// Êåâ Enter ÈîÆÂèëÈÄÅÊ∂àÊÅØÔºàChatbotËæìÂÖ•Ê°ÜÔºâ
document.getElementById('chatbotInput').addEventListener('keypress', function(event) {
    if (event.key === 'Enter') {
        sendChatbotMessage();
    }
});
</script>
</body>
</html>
