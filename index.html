<!DOCTYPE html>
<html>
<head>
<title>Innomath Hub</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>

body{
    margin: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #4a6bc2 0%, #027499 100%);
    min-height: 100vh;
}

/* ğŸ” ç™»å½•/æ³¨å†Œé¡µé¢æ ·å¼ */
.auth-page {
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    padding: 20px;
}

.auth-container {
    max-width: 400px;
    width: 90%;
    background: rgba(255, 255, 255, 0.25);
    border-radius: 15px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.25);
    padding: 40px 30px;
    backdrop-filter: blur(8px);
    border: 1px solid rgba(255, 255, 255, 0.35);
    text-align: center;
}

.auth-logo {
    color: white;
    font-size: 36px;
    font-weight: 700;
    margin-bottom: 10px;
    text-shadow: 0 2px 10px rgba(0,0,0,0.3);
}

.auth-subtitle {
    color: #bbdefb;
    font-size: 16px;
    margin-bottom: 30px;
}

/* åˆ‡æ¢æ ‡ç­¾æ ·å¼ */
.auth-tabs {
    display: flex;
    margin-bottom: 30px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 10px;
    padding: 5px;
}

.auth-tab {
    flex: 1;
    padding: 12px;
    color: white;
    cursor: pointer;
    border-radius: 8px;
    transition: all 0.3s;
    font-weight: 500;
}

.auth-tab.active {
    background: white;
    color: #1a237e;
}

/* è¡¨å•æ ·å¼ */
.auth-form {
    display: block;
}

.hidden {
    display: none;
}

.input-group {
    margin-bottom: 20px;
    text-align: left;
}

.input-group label {
    display: block;
    color: white;
    margin-bottom: 8px;
    font-weight: 500;
}

.input-group input {
    width: 100%;
    padding: 14px;
    border: 2px solid rgba(255, 255, 255, 0.3);
    border-radius: 8px;
    background: rgba(255, 255, 255, 0.9);
    font-size: 16px;
    box-sizing: border-box;
    transition: all 0.3s;
}

.input-group input:focus {
    outline: none;
    border-color: #4a6bc2;
    box-shadow: 0 0 0 3px rgba(74, 107, 194, 0.3);
}

.auth-button {
    width: 100%;
    background: white;
    color: #1a237e;
    padding: 16px;
    font-size: 18px;
    font-weight: 700;
    border-radius: 10px;
    border: none;
    cursor: pointer;
    transition: all 0.3s;
    margin-top: 10px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.2);
}

.auth-button:hover {
    background: #f5f5f5;
    transform: translateY(-3px);
    box-shadow: 0 15px 35px rgba(0,0,0,0.3);
}

.error-message {
    color: #d32f2f;
    font-size: 15px;
    margin: 15px 0;
    display: none;
    background: #ffebee;
    padding: 14px;
    border-radius: 8px;
    border: 2px solid #ef5350;
    font-weight: 700;
    text-align: center;
    animation: shake 0.5s ease;
    box-shadow: 0 4px 12px rgba(239, 83, 80, 0.2);
}

@keyframes shake {
    0%, 100% { transform: translateX(0); }
    25% { transform: translateX(-5px); }
    75% { transform: translateX(5px); }
}

.success-message {
    color: #4CAF50;
    font-size: 14px;
    margin-top: 15px;
    display: none;
}

.guest-option {
    margin-top: 25px;
    color: rgba(255, 255, 255, 0.7);
    font-size: 14px;
}

.guest-link {
    color: #bbdefb;
    text-decoration: underline;
    cursor: pointer;
    font-weight: 500;
}

.main-container {
    display: none;
    min-height: 100vh;
    padding: 20px;
    box-sizing: border-box;
}

.container {
    max-width: 800px;
    margin: 0 auto;
    background: rgba(255, 255, 255, 0.25);
    border-radius: 15px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.25);
    overflow: hidden;
    backdrop-filter: blur(8px);
    border: 1px solid rgba(255, 255, 255, 0.35);
}

header{
    padding: 40px 20px;
    color: white;
    background: rgba(255, 255, 255, 0.15);
    border-bottom: 1px solid rgba(255, 255, 255, 0.2);
    text-align: center; 
    display: flex;
    flex-direction: column;
    align-items: center; 
}

header h1{
    margin: 0 0 15px 0;
    font-size: 50px;
    font-weight: 700;
    color: white;
    text-shadow: 0 2px 10px rgba(0,0,0,0.3);
    text-align: center; 
    width: 100%; 
}

.subtitle {
    font-size: 18px;
    color: #ffffff;
    margin-bottom: 20px;
    font-weight: 500;
    text-shadow: 0 1px 3px rgba(0,0,0,0.5);
    text-align: center; 
    width: 100%; 
}

.separator {
    height: 1px;
    background: rgba(255,255,255,0.3);
    margin: 25px auto;
    width: 100px;
    text-align: center; 
}

.tagline {
    font-size: 18px;
    color: #ffffff;
    font-weight: 500;
    margin-top: 15px;
    text-shadow: 0 1px 3px rgba(0,0,0,0.5);
    text-align: center; 
    width: 100%; 
}

.main-content {
    padding: 40px 20px;
}

.section-title {
    color: white;
    font-size: 28px;
    margin-bottom: 25px;
    font-weight: 600;
	text-align:center;
}

.main-button {
    display: block;
    background: white;
    color: #1a237e;
    padding: 18px 30px;
    font-size: 20px;
    font-weight: 700;
    border-radius: 10px;
    text-decoration: none;
    margin: 15px auto;
    transition: all 0.3s;
    border: none;
    cursor: pointer;
    width: 320px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.2);
}

.main-button:hover {
    background: #f5f5f5;
    transform: translateY(-5px);
    box-shadow: 0 15px 35px rgba(0,0,0,0.3);
}

.file-options {
    display: none;
    padding: 40px 20px;
}

.file-title {
    color: white;
    font-size: 24px;
    margin-bottom: 30px;
    font-weight: 600;
	text-align:center;
}

.file-button {
    display: block;
    background: rgba(255, 255, 255, 0.9);
    color: #1a237e;
    padding: 18px 40px;
    font-size: 18px;
    font-weight: 600;
    border-radius: 10px;
    text-decoration: none;
    margin: 15px auto;
    transition: all 0.3s;
    border: none;
    cursor: pointer;
    width: 280px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
}

.file-button:hover {
    background: white;
    transform: translateY(-3px);
    box-shadow: 0 10px 25px rgba(0,0,0,0.3);
}

.back-button {
    display: inline-block;
    background: rgba(255, 255, 255, 0.2);
    color: white;
    padding: 12px 30px;
    font-size: 14px;
    font-weight: 500;
    border-radius: 8px;
    text-decoration: none;
    margin-top: 30px;
    transition: all 0.3s;
    border: 1px solid rgba(255,255,255,0.3);
    cursor: pointer;
}

.back-button:hover {
    background: rgba(255, 255, 255, 0.3);
}

footer {
    padding: 20px;
    color: rgba(255, 255, 255, 0.7);
    font-size: 14px;
    border-top: 1px solid rgba(255,255,255,0.1);
	text-align: center;
}

/* è¿›åº¦æ¡æ ·å¼ */
.progress-section-bottom {
    margin: 50px auto 30px auto;
    padding: 25px;
    background: rgba(255, 255, 255, 0.15);
    border-radius: 15px;
    border: 1px solid rgba(255, 255, 255, 0.2);
    max-width: 500px;
}

.progress-title {
    color: white;
    font-size: 20px;
    margin-bottom: 20px;
    text-align: center;
    font-weight: 600;
}

.progress-container {
    margin-bottom: 20px;
}

.progress-label {
    display: flex;
    justify-content: space-between;
    margin-bottom: 8px;
    color: white;
    font-size: 15px;
    font-weight: 500;
}

.progress-percent {
    color: #FFD700;
    font-weight: 600;
}

.progress-bar {
    height: 10px;
    background: rgba(255, 255, 255, 0.2);
    border-radius: 5px;
    overflow: hidden;
}

.progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #4FC3F7, #2979FF);
    border-radius: 5px;
    transition: width 0.5s ease;
}
.progress-actions {
    text-align: center;
    margin-top: 20px;
}

.update-btn {
    background: rgba(255, 255, 255, 0.2);
    color: white;
    border: 1px solid rgba(255, 255, 255, 0.3);
    padding: 8px 16px;
    border-radius: 6px;
    cursor: pointer;
    margin-bottom: 8px;
}

.update-btn:hover {
    background: rgba(255, 255, 255, 0.3);
}

.progress-actions small {
    color: rgba(255, 255, 255, 0.7);
    font-size: 12px;
}

/* è®¡ç®—å™¨æ ·å¼ */
.calculator-section {
    margin: 40px auto 30px auto;
    padding: 25px;
    background: rgba(255, 255, 255, 0.15);
    border-radius: 15px;
    border: 1px solid rgba(255, 255, 255, 0.2);
    max-width: 500px;
}

.calculator-title {
    color: white;
    font-size: 20px;
    margin-bottom: 20px;
    text-align: center;
    font-weight: 600;
}

.calculator-input {
    color: white;
}

.calculator-input label {
    display: block;
    margin-bottom: 10px;
    font-weight: 500;
}

#functionInput {
    width: 100%;
    padding: 12px;
    background: rgba(255, 255, 255, 0.9);
    border: 2px solid rgba(255, 255, 255, 0.3);
    border-radius: 8px;
    font-size: 16px;
    margin-bottom: 15px;
    box-sizing: border-box;
}

.calculator-buttons {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
}

.calc-btn {
    flex: 1;
    padding: 12px;
    background: white;
    color: #1a237e;
    border: none;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
}

.calc-btn:hover {
    background: #f5f5f5;
    transform: translateY(-2px);
}

.example-btn {
    background: rgba(255, 255, 255, 0.8);
}

.result-box {
    background: rgba(255, 255, 255, 0.1);
    padding: 15px;
    border-radius: 8px;
    margin-top: 20px;
    border-left: 4px solid #4FC3F7;
}

.result-box h4 {
    margin-top: 0;
    color: white;
}

#derivativeResult, #stepByStep {
    font-family: 'Courier New', monospace;
    background: rgba(0, 0, 0, 0.2);
    padding: 10px;
    border-radius: 5px;
    margin: 5px 0;
}

.quick-functions {
    margin-top: 20px;
}

.quick-functions p {
    margin-bottom: 10px;
    font-size: 14px;
}

.quick-btn {
    padding: 8px 12px;
    margin: 0 5px 5px 0;
    background: rgba(255, 255, 255, 0.2);
    color: white;
    border: 1px solid rgba(255, 255, 255, 0.3);
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.3s;
}

.quick-btn:hover {
    background: rgba(255, 255, 255, 0.3);
}

</style>
</head>
<body>

<!-- ğŸ” ç™»å½•/æ³¨å†Œé¡µé¢ -->
<div class="auth-page" id="authPage">
    <div class="auth-container">
        <div class="auth-logo">INNOMATH HUB</div>
        <div class="auth-subtitle">Your Ultimate Study Companion</div>
        
        <!-- åˆ‡æ¢æ ‡ç­¾ -->
        <div class="auth-tabs">
            <div class="auth-tab active" onclick="showLoginForm()">LOGIN</div>
            <div class="auth-tab" onclick="showRegisterForm()">CREATE ACCOUNT</div>
        </div>
        
        <!-- ç™»å½•è¡¨å• -->
        <form class="auth-form" id="loginForm" onsubmit="event.preventDefault(); login();">
            <div class="input-group">
                <label for="loginUsername">Username</label>
                <input type="text" id="loginUsername" placeholder="Enter your username" required>
            </div>
            
            <div class="input-group">
                <label for="loginPassword">Password</label>
                <input type="password" id="loginPassword" placeholder="Enter your password" required>
            </div>
            
            <div class="error-message" id="loginError">
                Invalid username or password
            </div>
            
            <button type="submit" class="auth-button">LOGIN</button>
            
            <div class="guest-option">
                Or continue as <span class="guest-link" onclick="continueAsGuest()">Guest</span>
            </div>
        </form>
        
        <!-- æ³¨å†Œè¡¨å• -->
        <form class="auth-form hidden" id="registerForm" onsubmit="event.preventDefault(); register();">
            <div class="input-group">
                <label for="regUsername">Username</label>
                <input type="text" id="regUsername" placeholder="Choose a username" required>
            </div>
            
            <div class="input-group">
                <label for="regEmail">Email</label>
                <input type="email" id="regEmail" placeholder="Enter your email" required>
            </div>
            
            <div class="input-group">
                <label for="regPassword">Password</label>
                <input type="password" id="regPassword" placeholder="Choose a password" required>
            </div>
            
            <div class="input-group">
                <label for="regConfirmPassword">Confirm Password</label>
                <input type="password" id="regConfirmPassword" placeholder="Confirm password" required>
            </div>
            
            <div class="error-message" id="registerError">
                Passwords do not match or username already exists
            </div>
            
            <div class="success-message" id="registerSuccess">
                Account created successfully! Please login.
            </div>
            
            <button type="submit" class="auth-button">CREATE ACCOUNT</button>
            
            <div class="guest-option">
                Already have an account? <span class="guest-link" onclick="showLoginForm()">Login here</span>
            </div>
        </form>
    </div>
</div>

<!-- ä¸»å†…å®¹ -->
<div class="main-container" id="mainContainer">
    <div class="container">
        <header>
            <h1>INNOMATH HUB</h1>
            <div class="subtitle">Practice today, conquer tomorrow.</div>
            
            <div class="separator"></div>
            
            <div class="tagline">Your Ultimate Study Companion</div>
        </header>
        
        <div class="main-content" id="mainContent">
            <div class="section-title">Study Materials</div>
            <button class="main-button" onclick="showFileOptions()">ğŸ–ŠTopic 9 QUESTIONS</button>
            <button class="main-button" onclick="openGoogleForm()">QUIZ</button>
			<button class="main-button" onclick="showYoutubeOptions()">ğŸ¦VIDEO TUTORIALS</button>
        </div>
        
        <div class="file-options" id="fileOptions">
            <div class="file-title">Select File </div>
            <a href="https://drive.google.com/file/d/1n-8998E7Znrykz5ZyOHFDv94RhMYDno4/view?usp=sharing" class="file-button" target="_blank">KMNS</a>
            <a href="https://drive.google.com/file/d/1AP6yhfksl5VfavpI-S6dts6z3vslP9YO/view?usp=sharing" class="file-button" target="_blank">KMM</a>
            <a href="https://drive.google.com/file/d/1qZly6g2X6s4MaT1wkZ48n9B0Fg0oEQGN/view?usp=sharing" class="file-button" target="_blank">KMPK</a>
            <button class="back-button" onclick="hideFileOptions()">â† Back to Main</button>
        </div>
        
		<div class="file-options" id="youtubeOptions">
			<div class="file-title">Differentiation Tutorials</div>
    
			<a href="" class="file-button" target="_blank">ğŸ“˜ Differentiation Basics</a>
			<a href="https://www.youtube.com/watch?v=WUvTyaaNkzM" class="file-button" target="_blank">ğŸ“— Chain Rule Tutorial</a>
			<a href="https://www.youtube.com/watch?v=YG15m2VwSjA" class="file-button" target="_blank">ğŸ“™ Product & Quotient Rules</a>
			<a href="https://www.youtube.com/watch?v=ANyVpMS3HL4" class="file-button" target="_blank">ğŸ“’ Applications of Derivatives</a>
			<button class="back-button" onclick="hideYoutubeOptions()">â† Back to Main</button>
		</div>

        <!-- è¿›åº¦æ¡éƒ¨åˆ† -->
        <div class="progress-section-bottom" id="progressSection">
            <h3 class="progress-title">ğŸ“Š Your Learning Progress</h3>
            
            <div class="progress-container">
                <div class="progress-label">
                    <span>Topic 9 Completion</span>
                    <span class="progress-percent" id="topicProgress">55%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="topicBar" style="width: 55%"></div>
                </div>
            </div>
            
            <div class="progress-container">
                <div class="progress-label">
                    <span>Quiz Performance</span>
                    <span class="progress-percent" id="quizProgress">60%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="quizBar" style="width: 60%"></div>
                </div>
            </div>
            
            <div class="progress-container">
                <div class="progress-label">
                    <span>Video Tutorials Watched</span>
                    <span class="progress-percent" id="videoProgress">40%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="videoBar" style="width: 40%"></div>
                </div>
            </div>
			
			<!-- åœ¨è¿›åº¦æ¡éƒ¨åˆ†æ·»åŠ  -->
			<div class="progress-actions">
				<button class="update-btn" onclick="updateProgressManually()">Update Progress</button>
				<small>Complete activities to increase progress</small>
			</div>
        </div>
        
        <!-- å¾®åˆ†è®¡ç®—å™¨ -->
        <div class="calculator-section" id="calculatorSection">
            <h3 class="calculator-title">ğŸ§® Differentiation Calculator</h3>
            
            <div class="calculator-input">
                <label for="functionInput">Enter function f(x):</label>
                <input type="text" id="functionInput" placeholder="e.g., 3x^2 + 2x - 5" value="3x^2 + 2x - 5">
                
                <div class="calculator-buttons">
                    <button class="calc-btn" onclick="calculateDerivative()">Calculate Derivative</button>
                    <button class="calc-btn example-btn" onclick="showExample()">Show Example</button>
                </div>
                
                <div class="result-box" id="resultBox">
                    <h4>Result:</h4>
                    <p id="derivativeResult">Enter a function above</p>
                    <p id="stepByStep"></p>
                </div>
                
                <div class="quick-functions">
                    <p>Quick functions:</p>
                    <button class="quick-btn" onclick="insertFunction('x^2')">xÂ²</button>
                    <button class="quick-btn" onclick="insertFunction('sin(x)')">sin(x)</button>
                    <button class="quick-btn" onclick="insertFunction('cos(x)')">cos(x)</button>
                    <button class="quick-btn" onclick="insertFunction('e^x')">eË£</button>
                    <button class="quick-btn" onclick="insertFunction('ln(x)')">ln(x)</button>
                </div>
            </div>
        </div>
		
        <footer>
            Â© 2026 Innomathematics Hub. All rights reserved.
        </footer>
    </div>
</div>

<script>
// å­˜å‚¨ç”¨æˆ·æ•°æ®ï¼ˆåœ¨å®é™…åº”ç”¨ä¸­åº”è¯¥ä½¿ç”¨æœåŠ¡å™¨æ•°æ®åº“ï¼‰
let users = JSON.parse(localStorage.getItem('innomath_users')) || [
    {username: 'admin', email: 'admin@example.com', password: '1234'}
];

// åˆ‡æ¢è¡¨å•æ˜¾ç¤º
function showLoginForm() {
    document.getElementById('loginForm').classList.remove('hidden');
    document.getElementById('registerForm').classList.add('hidden');
    document.querySelectorAll('.auth-tab')[0].classList.add('active');
    document.querySelectorAll('.auth-tab')[1].classList.remove('active');
    clearMessages();
}

function showRegisterForm() {
    document.getElementById('loginForm').classList.add('hidden');
    document.getElementById('registerForm').classList.remove('hidden');
    document.querySelectorAll('.auth-tab')[0].classList.remove('active');
    document.querySelectorAll('.auth-tab')[1].classList.add('active');
    clearMessages();
}

function clearMessages() {
    document.getElementById('loginError').style.display = 'none';
    document.getElementById('registerError').style.display = 'none';
    document.getElementById('registerSuccess').style.display = 'none';
}

// æ³¨å†ŒåŠŸèƒ½
function register() {
    const username = document.getElementById('regUsername').value.trim();
    const email = document.getElementById('regEmail').value.trim();
    const password = document.getElementById('regPassword').value;
    const confirmPassword = document.getElementById('regConfirmPassword').value;
    
    const errorElement = document.getElementById('registerError');
    const successElement = document.getElementById('registerSuccess');
    
    // æ¸…é™¤ä¹‹å‰çš„æ¶ˆæ¯
    errorElement.style.display = 'none';
    successElement.style.display = 'none';
    
    // éªŒè¯è¾“å…¥
    if (password !== confirmPassword) {
        errorElement.textContent = 'Passwords do not match';
        errorElement.style.display = 'block';
        return;
    }
    
    if (password.length < 4) {
        errorElement.textContent = 'Password must be at least 4 characters';
        errorElement.style.display = 'block';
        return;
    }
    
    // æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å·²å­˜åœ¨
    if (users.some(user => user.username === username)) {
        errorElement.textContent = 'Username already exists';
        errorElement.style.display = 'block';
        return;
    }
    
    // æ£€æŸ¥é‚®ç®±æ˜¯å¦å·²å­˜åœ¨
    if (users.some(user => user.email === email)) {
        errorElement.textContent = 'Email already registered';
        errorElement.style.display = 'block';
        return;
    }
    
    // åˆ›å»ºæ–°ç”¨æˆ·
    const newUser = {
        username: username,
        email: email,
        password: password
    };
    
    users.push(newUser);
    localStorage.setItem('innomath_users', JSON.stringify(users));
    
    // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
    successElement.textContent = 'Account created successfully! Please login.';
    successElement.style.display = 'block';
    
    // æ¸…ç©ºè¡¨å•
    document.getElementById('regUsername').value = '';
    document.getElementById('regEmail').value = '';
    document.getElementById('regPassword').value = '';
    document.getElementById('regConfirmPassword').value = '';
    
    // 3ç§’ååˆ‡æ¢åˆ°ç™»å½•è¡¨å•
    setTimeout(() => {
        showLoginForm();
        document.getElementById('loginUsername').value = username;
    }, 2000);
}

// ç™»å½•åŠŸèƒ½
function login() {
    const username = document.getElementById('loginUsername').value.trim();
    const password = document.getElementById('loginPassword').value;
    const errorElement = document.getElementById('loginError');
    
    errorElement.style.display = 'none';
    
    // æŸ¥æ‰¾ç”¨æˆ·
    const user = users.find(u => u.username === username && u.password === password);
    
    if (user) {
        // ç™»å½•æˆåŠŸ
        document.getElementById('authPage').style.display = 'none';
        document.getElementById('mainContainer').style.display = 'block';
        // å¯ä»¥åœ¨è¿™é‡Œå­˜å‚¨å½“å‰ç”¨æˆ·ä¿¡æ¯
        localStorage.setItem('current_user', JSON.stringify(user));
    } else {
        // ç™»å½•å¤±è´¥
        errorElement.style.display = 'block';
    }
}

// è®¿å®¢è®¿é—®
function continueAsGuest() {
    document.getElementById('authPage').style.display = 'none';
    document.getElementById('mainContainer').style.display = 'block';
}

// æŒ‰Enteré”®æäº¤è¡¨å•
document.addEventListener('keypress', function(event) {
    if (event.key === 'Enter') {
        if (!document.getElementById('loginForm').classList.contains('hidden')) {
            login();
        } else {
            register();
        }
    }
});

// åŸæœ‰åŠŸèƒ½ä¿æŒä¸å˜
function showFileOptions() {
    document.getElementById('mainContent').style.display = 'none';
    document.getElementById('fileOptions').style.display = 'block';
}

function openGoogleForm() {
    // æ›¿æ¢æˆä½ çš„Google Formé“¾æ¥
    window.open('https://forms.gle/iuWpAK8gUEqwYqVp8', '_blank');
}

function hideFileOptions() {
    document.getElementById('fileOptions').style.display = 'none';
    document.getElementById('mainContent').style.display = 'block';
}

// é¡µé¢åŠ è½½æ—¶æ˜¾ç¤ºç™»å½•è¡¨å•
document.addEventListener('DOMContentLoaded', function() {
    showLoginForm();
});

function showYoutubeOptions() {
    document.getElementById('mainContent').style.display = 'none';
    document.getElementById('youtubeOptions').style.display = 'block';
}

// éšè—YouTubeé€‰é¡¹
function hideYoutubeOptions() {
    document.getElementById('youtubeOptions').style.display = 'none';
    document.getElementById('mainContent').style.display = 'block';
}

// ä¿®æ”¹åŸæ¥çš„éšè—å‡½æ•°ï¼Œæ·»åŠ YouTubeé€‰é¡¹
function hideFileOptions() {
    document.getElementById('fileOptions').style.display = 'none';
    document.getElementById('youtubeOptions').style.display = 'none'; // æ·»åŠ è¿™ä¸€è¡Œ
    document.getElementById('mainContent').style.display = 'block';
}

document.addEventListener('DOMContentLoaded', function() {
    showLoginForm();
    // ç¡®ä¿è¿›åº¦ä»0å¼€å§‹
    if (!localStorage.getItem('progress')) {
        localStorage.setItem('progress', JSON.stringify({topic: 0, quiz: 0, video: 0}));
    }
    loadProgress();
});
	
function loadProgress() {
    const savedProgress = localStorage.getItem('progress');
    if (savedProgress) {
        const progress = JSON.parse(savedProgress);
        updateProgress(progress.topic, progress.quiz, progress.video);
    } else {
        // ä»0å¼€å§‹
        updateProgress(0, 0, 0);
    }
}

// ä¿®å¤è¿›åº¦æ›´æ–°å‡½æ•°ï¼Œåªåœ¨å®Œæˆå­¦ä¹ æ´»åŠ¨æ—¶å¢é•¿
function updateProgressOnActivity(activityType) {
    const progress = JSON.parse(localStorage.getItem('progress') || '{"topic":55,"quiz":60,"video":40}');
    
    // æ ¹æ®æ´»åŠ¨ç±»å‹å¢åŠ å¯¹åº”çš„è¿›åº¦
    switch(activityType) {
        case 'practice':
            if (progress.topic < 100) {
                progress.topic = Math.min(100, progress.topic + 5); // æ¯æ¬¡ç»ƒä¹ å¢åŠ 5%
            }
            break;
        case 'quiz':
            if (progress.quiz < 100) {
                progress.quiz = Math.min(100, progress.quiz + 10); // æ¯æ¬¡æµ‹éªŒå¢åŠ 10%
            }
            break;
        case 'video':
            if (progress.video < 100) {
                progress.video = Math.min(100, progress.video + 20); // æ¯æ¬¡çœ‹è§†é¢‘å¢åŠ 20%
            }
            break;
    }
    
    updateProgress(progress.topic, progress.quiz, progress.video);
}
// æ·»åŠ è¿™äº›å‡½æ•°æ¥æ›´æ–°è¿›åº¦
function updateProgressManually() {
    const progress = JSON.parse(localStorage.getItem('progress') || '{"topic":0,"quiz":0,"video":0}');
    
    // è¯¢é—®ç”¨æˆ·å®Œæˆäº†ä»€ä¹ˆæ´»åŠ¨
    const activity = prompt('What did you complete?\n1. Practice questions\n2. Quiz\n3. Video tutorial\n\nEnter 1, 2, or 3:');
    
    switch(activity) {
        case '1':
            progress.topic = Math.min(100, progress.topic + 10);
            alert('Great! Practice progress increased by 10%');
            break;
        case '2':
            progress.quiz = Math.min(100, progress.quiz + 15);
            alert('Well done! Quiz progress increased by 15%');
            break;
        case '3':
            progress.video = Math.min(100, progress.video + 20);
            alert('Good job! Video progress increased by 20%');
            break;
        default:
            alert('No progress updated. Please enter 1, 2, or 3 next time.');
    }
    
    updateProgress(progress.topic, progress.quiz, progress.video);
}

// è‡ªåŠ¨æ›´æ–°è¿›åº¦çš„å‡½æ•°
function completePractice() {
    const progress = JSON.parse(localStorage.getItem('progress') || '{"topic":0,"quiz":0,"video":0}');
    if (progress.topic < 100) {
        progress.topic = Math.min(100, progress.topic + 5);
        updateProgress(progress.topic, progress.quiz, progress.video);
    }
}

function completeQuiz() {
    const progress = JSON.parse(localStorage.getItem('progress') || '{"topic":0,"quiz":0,"video":0}');
    if (progress.quiz < 100) {
        progress.quiz = Math.min(100, progress.quiz + 10);
        updateProgress(progress.topic, progress.quiz, progress.video);
    }
}

function completeVideo() {
    const progress = JSON.parse(localStorage.getItem('progress') || '{"topic":0,"quiz":0,"video":0}');
    if (progress.video < 100) {
        progress.video = Math.min(100, progress.video + 15);
        updateProgress(progress.topic, progress.quiz, progress.video);
    }
}

// æ›¿æ¢ calculateDerivative() å‡½æ•°
function calculateDerivative() {
    const input = document.getElementById('functionInput').value.trim();
    const resultElement = document.getElementById('derivativeResult');
    const stepsElement = document.getElementById('stepByStep');
    
    if (!input) {
        resultElement.textContent = 'Please enter a function';
        stepsElement.textContent = '';
        return;
    }
    
    // ç®€å•ä½†æœ‰æ•ˆçš„å¾®åˆ†è®¡ç®—
    try {
        // æ¸…ç†è¾“å…¥ï¼Œå…è®¸ç©ºæ ¼
        let func = input.replace(/\s+/g, '');
        
        // æ”¯æŒçš„å‡½æ•°ç±»å‹
        let derivative = '';
        let steps = 'Steps:\n';
        
        // 1. å¹‚å‡½æ•°: ax^n
        if (func.includes('x^')) {
            const match = func.match(/(-?\d*)x\^(-?\d+)/);
            if (match) {
                const coefficient = match[1] === '' || match[1] === '-' ? (match[1] === '-' ? -1 : 1) : parseInt(match[1]);
                const power = parseInt(match[2]);
                
                const newCoefficient = coefficient * power;
                const newPower = power - 1;
                
                if (newPower === 0) {
                    derivative = newCoefficient.toString();
                } else if (newPower === 1) {
                    derivative = newCoefficient + 'x';
                } else {
                    derivative = newCoefficient + 'x^' + newPower;
                }
                
                steps += `Power rule: d/dx(${coefficient}x^${power}) = ${newCoefficient}x^${newPower}\n`;
            }
        }
        // 2. çº¿æ€§å‡½æ•°: ax
        else if (func.includes('x') && !func.includes('^')) {
            const match = func.match(/(-?\d*)x/);
            if (match) {
                const coefficient = match[1] === '' || match[1] === '-' ? (match[1] === '-' ? -1 : 1) : parseInt(match[1]);
                derivative = coefficient.toString();
                steps += `d/dx(${coefficient}x) = ${coefficient}\n`;
            }
        }
        // 3. ä¸‰è§’å‡½æ•°
        else if (func === 'sin(x)') {
            derivative = 'cos(x)';
            steps += 'd/dx(sin(x)) = cos(x)\n';
        }
        else if (func === 'cos(x)') {
            derivative = '-sin(x)';
            steps += 'd/dx(cos(x)) = -sin(x)\n';
        }
        // 4. æŒ‡æ•°å’Œå¯¹æ•°
        else if (func === 'e^x') {
            derivative = 'e^x';
            steps += 'd/dx(e^x) = e^x\n';
        }
        else if (func === 'ln(x)') {
            derivative = '1/x';
            steps += 'd/dx(ln(x)) = 1/x\n';
        }
        // 5. å¤šé¡¹å¼: 3x^2 + 2x + 1
        else if (func.includes('+') || func.includes('-')) {
            // ç®€å•çš„å¤šé¡¹å¼å¤„ç†
            derivative = calculatePolynomialDerivative(func);
            steps += 'Using power rule on each term\n';
        }
        // 6. å¸¸æ•°
        else if (!isNaN(func)) {
            derivative = '0';
            steps += 'd/dx(constant) = 0\n';
        }
        else {
            derivative = 'æ— æ³•è®¡ç®—ï¼Œè¯·ä½¿ç”¨æ ‡å‡†æ ¼å¼';
            steps = 'æ”¯æŒæ ¼å¼: x^2, 3x, sin(x), cos(x), e^x, ln(x), 3x^2+2x+1';
        }
        
        resultElement.textContent = `f'(x) = ${derivative}`;
        stepsElement.textContent = steps;
        
        // è®¡ç®—æˆåŠŸæ—¶å¢åŠ ä¸€ç‚¹ç‚¹è¿›åº¦ï¼ˆå¯é€‰ï¼‰
        const progress = JSON.parse(localStorage.getItem('progress') || '{"topic":0,"quiz":0,"video":0}');
        if (progress.topic < 100 && derivative !== 'æ— æ³•è®¡ç®—ï¼Œè¯·ä½¿ç”¨æ ‡å‡†æ ¼å¼') {
            progress.topic = Math.min(100, progress.topic + 1);
            updateProgress(progress.topic, progress.quiz, progress.video);
        }
        
    } catch (error) {
        resultElement.textContent = 'Error: è¯·ä½¿ç”¨æ ‡å‡†æ ¼å¼';
        stepsElement.textContent = 'ç¤ºä¾‹: 3x^2, 2x+5, sin(x), e^x';
    }
}

// å¤šé¡¹å¼å¾®åˆ†è®¡ç®—
function calculatePolynomialDerivative(func) {
    // åˆ†å‰²å„é¡¹
    const terms = func.replace(/([+-])/g, ' $1').trim().split(/\s+/);
    let derivativeTerms = [];
    
    for (let term of terms) {
        if (term === '+' || term === '-') continue;
        
        let cleanTerm = term;
        let sign = '';
        
        if (cleanTerm.startsWith('+') || cleanTerm.startsWith('-')) {
            sign = cleanTerm[0];
            cleanTerm = cleanTerm.substring(1);
        }
        
        // å¤„ç† x^n
        if (cleanTerm.includes('x^')) {
            const parts = cleanTerm.split('x^');
            let coeff = parts[0] === '' ? 1 : parseFloat(parts[0]);
            const power = parseFloat(parts[1]);
            
            if (sign === '-') coeff = -coeff;
            
            const newCoeff = coeff * power;
            const newPower = power - 1;
            
            let newTerm = '';
            if (newCoeff !== 0) {
                newTerm = (newCoeff >= 0 ? '+' : '') + 
                         (Math.abs(newCoeff) !== 1 ? Math.abs(newCoeff) : '') + 
                         'x' + 
                         (newPower !== 1 ? '^' + newPower : '');
                derivativeTerms.push(newTerm);
            }
        }
        // å¤„ç† x
        else if (cleanTerm.includes('x') && !cleanTerm.includes('^')) {
            let coeff = cleanTerm.replace('x', '');
            coeff = coeff === '' ? 1 : parseFloat(coeff);
            
            if (sign === '-') coeff = -coeff;
            
            if (coeff !== 0) {
                derivativeTerms.push((coeff >= 0 ? '+' : '') + coeff);
            }
        }
        // å¸¸æ•°é¡¹å¿½ç•¥ï¼ˆå¯¼æ•°ä¸º0ï¼‰
    }
    
    let result = derivativeTerms.join('');
    if (result.startsWith('+')) result = result.substring(1);
    return result || '0';
}

// ä¿®æ”¹ showExample() å‡½æ•°
function showExample() {
    document.getElementById('functionInput').value = '3x^2 + 2x - 5';
    calculateDerivative();
}

// æ’å…¥å¿«é€Ÿå‡½æ•°
function insertFunction(func) {
    const input = document.getElementById('functionInput');
    input.value = func;
}

// ä¿®æ”¹é¡µé¢åˆ‡æ¢å‡½æ•°ä»¥æ§åˆ¶è¿›åº¦æ¡æ˜¾ç¤º
function showFileOptions() {
    document.getElementById('mainContent').style.display = 'none';
    document.getElementById('fileOptions').style.display = 'block';
    document.getElementById('progressSection').style.display = 'none';
    document.getElementById('calculatorSection').style.display = 'none';
}

function hideFileOptions() {
    document.getElementById('fileOptions').style.display = 'none';
    document.getElementById('mainContent').style.display = 'block';
    document.getElementById('progressSection').style.display = 'block';
    document.getElementById('calculatorSection').style.display = 'block';
}

function showYoutubeOptions() {
    document.getElementById('mainContent').style.display = 'none';
    document.getElementById('youtubeOptions').style.display = 'block';
    document.getElementById('progressSection').style.display = 'none';
    document.getElementById('calculatorSection').style.display = 'none';
}

function hideYoutubeOptions() {
    document.getElementById('youtubeOptions').style.display = 'none';
    document.getElementById('mainContent').style.display = 'block';
    document.getElementById('progressSection').style.display = 'block';
    document.getElementById('calculatorSection').style.display = 'block';
}

// é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
document.addEventListener('DOMContentLoaded', function() {
    showLoginForm();
    loadProgress(); // åŠ è½½ä¿å­˜çš„è¿›åº¦
    
    // ä¸»é¡µé¢æ˜¾ç¤ºæ—¶æ˜¾ç¤ºè¿›åº¦æ¡å’Œè®¡ç®—å™¨
    if (document.getElementById('mainContainer').style.display === 'block') {
        document.getElementById('progressSection').style.display = 'block';
        document.getElementById('calculatorSection').style.display = 'block';
    }
});

// ä¿®æ”¹ç™»å½•æˆåŠŸå‡½æ•°ä»¥æ˜¾ç¤ºè¿›åº¦æ¡å’Œè®¡ç®—å™¨
function login() {
    const username = document.getElementById('loginUsername').value.trim();
    const password = document.getElementById('loginPassword').value;
    const errorElement = document.getElementById('loginError');
    
    errorElement.style.display = 'none';
    
    const user = users.find(u => u.username === username && u.password === password);
    
    if (user) {
        document.getElementById('authPage').style.display = 'none';
        document.getElementById('mainContainer').style.display = 'block';
        localStorage.setItem('current_user', JSON.stringify(user));
        
        // æ˜¾ç¤ºè¿›åº¦æ¡å’Œè®¡ç®—å™¨
        document.getElementById('progressSection').style.display = 'block';
        document.getElementById('calculatorSection').style.display = 'block';
        loadProgress();
    } else {
        errorElement.style.display = 'block';
    }
}

// ä¿®æ”¹è®¿å®¢è®¿é—®å‡½æ•°
function continueAsGuest() {
    document.getElementById('authPage').style.display = 'none';
    document.getElementById('mainContainer').style.display = 'block';
    document.getElementById('progressSection').style.display = 'block';
    document.getElementById('calculatorSection').style.display = 'block';
    loadProgress();
}

</script>

</body>
</html>
